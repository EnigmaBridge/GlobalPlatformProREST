{
    "protocol":"MPCv1",
    "processors":4,
    "names": null,
    "aid": "4d50434170706c657431",
    "apdu":[
    {
        "name":"INS_SETUP",
        "cla": "B0",  
        "ins": "01",  
        "p1": "@processors",
        "p2": "@dstcard",
        "data": null,
        "result": null
    },
    {
        "name":"INS_RESET",
        "cla": "B0",  
        "ins": "03",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": null
    },
    {
        "name":"INS_KEYGEN_INIT",
        "cla": "B0",  
        "ins": "10",   
        "p1": "@processors",
        "p2": "@dstcard",
        "data": null,
        "result": null
    },
    {
        "name":"INS_KEYGEN_RETRIEVE_HASH",
        "cla": "B0",          
        "ins": "11",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": "@hash"
    },
    {
        "name":"INS_KEYGEN_STORE_HASH",
        "cla": "B0",  
        "ins": "12",   
        "p1": "@srccard",
        "p2": "00",
        "data": "@hash", 
        "result": null
    },
    {
        "name":"INS_KEYGEN_STORE_PUBKEY",
        "cla": "B0",  
        "ins": "13",  
        "p1": "@srccard",
        "p2": "00",
        "data": "@pubkey",
        "result": null
    },
    {
        "name":"INS_KEYGEN_RETRIEVE_PUBKEY",
        "cla": "B0",  
        "ins": "14",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": "@pubkey"
    },
    {
        "name":"INS_KEYGEN_RETRIEVE_AGG_PUBKEY",
        "cla": "B0",  
        "ins": "16",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": "@aggkey"
    },
    {
        "name":"INS_ENCRYPT",
        "cla": "B0",  
        "ins": "50",  
        "p1": "00",
        "p2": "00",
        "data": "@ecpoint",
        "result": "@encecpoint"
    },
    {
        "name":"INS_DECRYPT",
        "cla": "B0",  
        "ins": "51",   
        "p1": "00",
        "p2": "00",
        "data": "@ciphertext",
        "result": "@dececpoint"
    },
    {
        "name":"INS_SIGN_INIT",
        "cla": "B0",  
        "ins": "70",   
        "p1": "@processors",
        "p2": "@dstcard",
        "data": null,
        "result": null
    },
    {
        "name":"INS_SIGN_RETRIEVE_HASH",
        "cla": "B0",  
        "ins": "71",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": "@signhash"
    },
    {
        "name":"INS_SIGN_STORE_HASH",
        "cla": "B0",  
        "ins": "72",   
        "p1": "@srccard",
        "p2": "00",
        "data": "@signhash", 
        "result": null
    },
    {
        "name":"INS_SIGN_STORE_RI",
        "cla": "B0",  
        "ins": "73",  
        "p1": "@srccard",
        "p2": "00",
        "data": "@signri", 
        "result": null
    },
    {
        "name":"INS_SIGN_RETRIEVE_RI",
        "cla": "B0",  
        "ins": "74",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": "@signri"
    },
    {
        "name":"INS_SIGN_RETRIEVE_R",
        "cla": "B0",  
        "ins": "76",   
        "p1": "00",
        "p2": "00",
        "data": null,
        "result": "@signr"
    },
    {
        "name":"INS_SIGN",
        "cla": "B0",  
        "ins": 77,   
        "p1": "00",
        "p2": "00",
        "data": "@signplaintext",
        "result": "@signature"
    }
    ],
    "create":"INS_SETUP",
    "destroy":"INS_RESET",
    "phases":[
    {
        "name":"keygen",
        "input":["@processors"],
        "apdus":[
            {
            "apdu":"INS_KEYGEN_INIT",
            "from":"@server",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_RETRIEVE_HASH",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_STORE_HASH",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_RETRIEVE_PUBKEY",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_STORE_PUBKEY",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_RETRIEVE_AGG_PUBKEY",
            "from":"@worker",
            "to":"@server",
            "result":"@aggkey"
            }
        ],
        "result":"@aggkey"
    },
    {
        "name":"decrypt",
        "apdus":[
            {
            "apdu":"INS_DECRYPT",
            "from":"@server",
            "to":"@worker",
            "result":"@decrypt"
            }
       ],
        "result":"@decrypt"
    },
    {
        "name":"sign",
        "apdus":[
            {
            "apdu":"INS_SIGN_INIT",
            "from":"@server",
            "to":"@worker"
            },
            {
            "apdu":"INS_SIGN_RETRIEVE_HASH",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_SIGN_STORE_HASH",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_RETRIEVE_RI",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_KEYGEN_STORE_RI",
            "from":"@worker",
            "to":"@worker"
            },
            {
            "apdu":"INS_SIGN",
            "from":"@worker",
            "to":"@server",
            "result":"@signature"
            }
        ],
        "result":"@signature"
    } 
    ]
}

